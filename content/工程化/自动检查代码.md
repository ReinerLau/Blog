---
title: 自动检查代码
tags:
  - 工程化
---
## 为什么需要自动检查代码

只要是人就有疏忽的时候，何况在一个复杂的项目流程中，要进行代码检查、格式化、单元测试等种种操作，实现自动化可以大大减少由于人为疏忽导致的代码质量问题

## huksy

一个功能开发完成总归有一个提交代码的操作，husky 就允许开发者在特定的 git 操作发生之前自动运行指定的脚本，这些脚本就负责执行保证代码质量的操作

安装依赖

```shell
pnpm add --save-dev husky
```

初始化

```shell
pnpm exec huksy init
```

这样根目录下就多一个一个 `.husky` 文件夹，要执行的脚本都放在这里面

下面就以使用 eslint 对代码进行静态分析为例子

创建 `.husky/pre-commit` hook，这个 hook 会在执行 `git commit` 后触发，可以在这个 hook 下添加代码静态分析的脚本，还有很多 [hook](https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks)

```shell
#!/bin/sh
pnpm exec eslint --fix .
```

::: tip
`#!/bin/sh` 特殊注释行，使用指定 shell 解释器执行脚本，加上了 vscode 里才有 shell 脚本的图标
:::

这样执行 `git commit` 后会自动对当前文件夹的文件进行静态分析